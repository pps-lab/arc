
# The experiment allows measuring network ping and bandwidth
exp:
  n_repetitions: 1
  host_types:
    small_client:
      n: 1
      check_status: True
      init_roles:
      - setup-network-delay
      $CMD$: "ping [% my_run.private_dns_second %] -c 100 &&  sleep 5 && iperf -c [% my_run.private_dns_second %] -r -i 1 -t 2 --parallel 32" # -t 2 --parallel 40

    small_server:
      n: 1
      check_status: False
      init_roles:
      - setup-network-delay
      $CMD$: "ping [% my_run.private_dns_first %] -c 100  && iperf -s"



  base_experiment:
    private_dns_first: "[% exp_host_lst | json_query('[?host_type==`small_client`].private_dns_name') | default(['<UNDEFINED-DNS>'], true) | first %]"
    private_dns_second: "[% exp_host_lst | json_query('[?host_type==`small_server`].private_dns_name') | default(['<UNDEFINED-DNS>'], true) | first %]"
