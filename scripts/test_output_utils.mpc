from Compiler.script_utils import output_utils as out_util

salary_A = sint(int(program.args[1]))
salary_B = sint(int(program.args[2]))

# 1 - salary a is greater
# 2 - salary b is greater
# 3 - both salaries are equal
def decide_larger_salary(salary_a, salary_b):
    comparison_result = salary_a.greater_than(salary_b)
    comparison_result_2 = salary_b.greater_than(salary_a)
    end_result = comparison_result.if_else(
        1,
        comparison_result_2.if_else(
            2,
            3
        )
    )
    return end_result

result = decide_larger_salary(salary_A, salary_B)
out_util.output_value("decision",result.reveal())

@for_range(start=0,stop=5,step=1)
def _(i):
    out_util.output_value("repeat_decision", result.reveal() + i, repeat=True)


# Now, we test constructing a dataframe from lists

column_names = ["colA","colB","colC"]
@for_range(start=0,stop=5,step=1)
def _(row_idx):
    for i,col_name in enumerate(column_names):
        out_util.output_value(col_name, row_idx*5 + i, repeat=True)

