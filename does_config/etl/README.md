# Output Processor

In this folder, you can find the Output Processor component of the evaluation framework.

## Overview

The output processor consists of the following files:

+ `mp_spdz_extractor.py` - This file contains the `MpSpdzStderrExtractor` and the `MpSpdzResultExtractor`
+ `mp_spdz_trasformers.py` - This file contains the `MpSpdzRowMergerTransformer` and `MpSpdzDataFrameBuilderTransformer`

For each class, we define a corresponding section.

## MpSpdzStderrExtractor

This Extractor parses the `stderr.log`, the file that contains the captured error output of the experiment. 
The `stderr.log` file contains the information about the amount of data sent over the network,
the timing information that has been captured by each MP-SPDZ virtual machine, and the number of MPC communication rounds 
completed by each player.

For this extractor, we support the following configuration options:
+ `timers` - If this option is present, we enable the timing processing facilities of this extractor. The option receives a list 
             of integers. Each integer in this list represents the timer with the same ID. Only the number `-1` represents the
             global timer. So, for instance, the configuration value: 
             ```
             ...
             MpSpdzStderrExtractor:
                timers: [-1, 1, 100]
             ...
             ```
             represents that the `MpSpdzStderrExtractor` will do timing processing, and it will process the 
             global timer (because of `-1`), the timer with ID `1` and the timer with ID `100`. 




## MpSpdzResultExtractor

This Extractor parses the `result-P*-*.txt` files and extracts the special output generated by the 
`output_utils.py` script_utils module. The Extractor parses these files for special formatted outputs and
generates for each parsed file a dictionary of name-value-mappings that are turned into Pandas DataFrame row and columns.

This extractor does not have any configuration options.


## MpSpdzRowMergerTransformer

This Transformer implements a wrapper to Pandas DataFrame's groupby and aggregate functionality.

The Transformer accepts the following options:

+ `groupby_columns` - A list of column names that should be used to group rows.
+ `apply_columns` - A dictionary that describe how the groupby results should be aggregated. Each dictionary entry represents a new 
  aggregation result column. The dictionary entry key itself represents the name of the column.

  Each dictionary entry contains a subdictionary that has the following entries:
  + `column_name` - The name of the column that should provide the aggregation data
  + `func` - The name of the function that should be applied to the given `column_name`. It defaults to `first` if 
    no value is given.


The Transformer supports the following functions:
+ `first` - Compute the first result of the given group.
+ `last` - Compute the last result of the given group
+ `describe` - Generate descriptive statistics for the group
+ `mean` - Compute the arithmetic mean of the group
+ `sum` - Compute the sum of the group
+ `size` - Compute the size of the group
+ `count` - Compute the count of the group
+ `std` - Compute the standard deviation of the group
+ `standard_deviation` - an alias for `std`
+ `var` - compute the variance of the group
+ `variance` - alias for `var`
+ `sem` - Compute the standard error of the mean of the group
+ `set_f` - compute the set of values of the group
+ `list_f` - compute the list of values of the group (retaining duplicates)


## MpSpdzDataFrameBuilderTransformer

This Transformer receives a set of column names. The columns should contain lists of values. 
These columns will then be expanded using the `DataFrame.explode()` function. The exploded values
will then added to the original dataframe received by the transformer as `<original-column-name>_expanded`.

The transformer accepts the following options:
+ `target_columns` - A list of column names that should be *exploded*.

Please note that the Transformer will only work, if the each target column in each row contains lists of values that are equally long.