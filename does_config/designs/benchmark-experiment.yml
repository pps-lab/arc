small_experiment_1:
  n_repetitions: 1
  host_types:
    hserv1:
      n: 1
      check_status: True
      init_roles:
        - ml-example-setup-1
        - setup-poetry
      $CMD$:
        - "bash {{exp_code_dir}}/utils/experiment-runner.sh \"{{exp_code_dir}}\" 0 2.0"
    hserv2:
      n: 2
      check_status: True
      init_roles:
        - ml-example-setup-1
        - setup-poetry
      $CMD$:
        - "bash {{exp_code_dir}}/utils/experiment-runner.sh \"{{exp_code_dir}}\" 1 2.0"
        - "bash {{exp_code_dir}}/utils/experiment-runner.sh \"{{exp_code_dir}}\" 2 2.0"
  base_experiment:
    mpc:
      player_count: 3
      player_0_hostname: "[% exp_host_lst | json_query(\"[?host_type=='hserv1'].private_dns_name\") | first %]"
      abs_path_to_code_dir: "{{exp_code_dir}}"
      script_name: "auditing_function_benchmark_script"
      script_args: 
        $FACTOR$: [
          ["1e-4", 38, 2, "[-1]"],
          ["1e-4", 38, 3, "[-1]"],
          ["1e-4", 38, 4, "[-1]"],
          ["1e-4", 38, 5, "[-1]"],
          ["1e-4", 38, 6, "[-1]"], 
          ["1e-4", 38, 7, "[-1]"],
          ["1e-4", 38, 8, "[-1]"],
          ["1e-4", 38, 9, "[-1]"],
          ["1e-4", 38, 10, "[-1]"]
        ]
      protocol_setup: "semi_honest_3"
      input_file_name: "mnist-audit-conv-10epoch.zip"

$ETL$:
  small_experiment_1_raw:
    experiments: [small_experiment_1]
    extractors:
      MpSpdzStderrExtractor:  {}
      MpSpdzResultExtractor: {}
      IgnoreExtractor: {}
    transformers: []
    loaders:
      CsvSummaryLoader:
        output_dir: etl_results
  small_experiment_1_dataframe:
    experiments: [small_experiment_1]
    extractors:
      MpSpdzStderrExtractor: {}
      MpSpdzResultExtractor: {}
      IgnoreExtractor: {}
    transformers:
      - name: MpSpdzDataFrameBuilderTransformer
        target_columns: ['model_0_loss', 'model_1_loss', 'model_2_loss', 'model_3_loss','model_0_mad_score', 'model_1_mad_score', 'model_2_mad_score', 'model_3_mad_score']
    loaders:
      CsvSummaryLoader:
        output_dir: etl_results
